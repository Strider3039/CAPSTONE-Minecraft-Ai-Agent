{
  "$schema": "https://json-schema.org/draft-07/schema",
  "title": "AI Agent Observation v1",
  "type": "object",
  "required": ["proto", "kind", "seq", "payload"],
  "properties": {
    "proto": { "type": "string", "const": "1" },
    "kind": { "type": "string", "const": "observation" },
    "seq": { "type": "integer", "minimum": 0 },
    "timestamp": { "type": "number" },
    "payload": {
      "type": "object",
      "required": ["pose", "rays", "entities", "world", "inventory", "collision"],
      "properties": {
        "pose": {
          "type": "object",
          "required": ["x", "y", "z", "yaw", "pitch"],
          "properties": {
            "x": { "type": "number" },
            "y": { "type": "number" },
            "z": { "type": "number" },
            "yaw": { "type": "number" },
            "pitch": { "type": "number" }
          },
          "additionalProperties": false
        },
        "rays": {
          "type": "array",
          "maxItems": 8,
          "items": {
            "type": "object",
            "required": ["hit", "dist"],
            "properties": {
              "hit": { "type": "boolean" },
              "dist": { "type": "number", "minimum": 0 }
            },
            "additionalProperties": false
          }
        },
        "front_clear": { "type": "boolean" },

        "entities": {
          "type": "array",
          "maxItems": 8,
          "items": {
            "type": "object",
            "required": ["id", "type", "dist"],
            "properties": {
              "id": { "type": "integer" },
              "type": { "type": "string" },
              "dist": { "type": "number", "minimum": 0 },
              "los": { "type": "boolean" },
              "tags": { "type": "array", "items": { "type": "string" } }
            },
            "additionalProperties": false
          }
        },
        "world": {
          "type": "object",
          "required": ["time_of_day", "weather", "biome"],
          "properties": {
            "time_of_day": { "type": "integer" },
            "weather": { "type": "string", "enum": ["clear", "rain", "thunder"] },
            "biome": { "type": "string" }
          },
          "additionalProperties": false
        },
        "inventory": {
          "type": "object",
          "required": ["selected_slot", "hotbar"],
          "properties": {
            "selected_slot": { "type": "integer", "minimum": 0, "maximum": 8 },
            "hotbar": {
              "type": "array",
              "minItems": 9,
              "maxItems": 9,
              "items": {
                "type": "object",
                "required": ["id", "count"],
                "properties": {
                  "id": { "type": "string" },
                  "count": { "type": "integer", "minimum": 0 }
                },
                "additionalProperties": false
              }
            }
          },
          "additionalProperties": false
        },
        "collision": {
          "type": "object",
          "required": ["is_grounded", "is_colliding", "no_progress"],
          "properties": {
            "is_grounded": { "type": "boolean" },
            "is_colliding": { "type": "boolean" },
            "no_progress": { "type": "boolean" }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
